import{a as c}from"./config-12ca6bfa.js";const h={data:[],async init(){this.data=await c.getAdminOrders(),this.data.length!==0?this.renderOrderPage():i.setAttribute("disabled","")},renderOrderPage(){p.innerHTML="";let a={},n={};this.data.forEach(r=>{r.products.forEach(t=>{a[t.title]===void 0?a[t.title]=t.price:a[t.title]+=t.price,n[t.category]===void 0?n[t.category]=t.price:n[t.category]+=t.price;const d=document.createElement("tr");p.appendChild(d);let e=document.createElement("td");e.textContent=r.id,d.appendChild(e),e=document.createElement("td"),d.appendChild(e);let l=document.createElement("p");l.textContent=r.user.name,e.appendChild(l),l=document.createElement("p"),l.textContent=r.user.tel,e.appendChild(l),e=document.createElement("td"),e.textContent=r.user.address,d.appendChild(e),e=document.createElement("td"),e.textContent=r.user.email,d.appendChild(e),e=document.createElement("td"),d.appendChild(e),l=document.createElement("p"),l.textContent=t.title,e.appendChild(l),e=document.createElement("td"),e.textContent=new Date(r.createdAt).toLocaleString().split(" ")[0],d.appendChild(e),e=document.createElement("td"),e.className="orderStatus",d.appendChild(e);const o=document.createElement("a");o.className="orderStatusLink",o.href="#",o.textContent=`${r.paid===!1?"未處理":"已處理"}`,e.appendChild(o),e=document.createElement("td"),d.appendChild(e);const s=document.createElement("input");s.className="delSingleOrder-Btn",s.type="button",s.value="刪除",s.setAttribute("data-id",r.id),e.appendChild(s),s.addEventListener("click",async u=>{const m=u.target.getAttribute("data-id");await this.deleteOrderById(m),this.data=await c.getAdminOrders(),this.data.length===0&&i.setAttribute("disabled",""),this.renderOrderPage()})})}),this.renderItemC3(a),this.renderProductC3(n)},renderItemC3(a){const n=[];Object.keys(a).forEach((t,d)=>{let e=[t,Object.values(a)[d]];n.push(e)}),n.sort((t,d)=>d[1]-t[1]);let r=["其他",0];n.forEach((t,d)=>{d>=3&&(r[1]+=t[1])}),n.splice(3,n.length-3),n.push(r),c3.generate({bindto:"#chart",data:{type:"pie",columns:n,colors:{"Louvre 雙人床架":"#DACBFF","Antony 雙人床架":"#9D7FEA","Anty 雙人床架":"#5434A7",其他:"#301E5F"}}})},renderProductC3(a){let n=[];Object.keys(a).forEach((r,t)=>{let d=[r,Object.values(a)[t]];n.push(d)}),c3.generate({bindto:"#chart1",data:{type:"pie",columns:n,colors:{"Louvre 雙人床架":"#DACBFF","Antony 雙人床架":"#9D7FEA","Anty 雙人床架":"#5434A7",其他:"#301E5F"}}})},async deleteOrderById(a){await c.deleteOrderById(a),await c.getAdminOrders(),this.data!==0?this.renderOrderPage():i.setAttribute("disabled","")},async deleteAllOrders(){await c.deleteAllOrders(),this.data=await c.getAdminOrders(),this.data.length===0&&i.setAttribute("disabled",""),this.renderOrderPage()}},i=document.querySelector(".discardAllBtn"),C=document.querySelector(".orderPage-table"),p=document.createElement("tbody");C.appendChild(p);h.init();i.addEventListener("click",a=>{h.deleteAllOrders()});
