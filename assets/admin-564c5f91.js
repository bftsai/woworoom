import{a as c}from"./config-2b76b15a.js";const y={data:[],async init(){this.data=await c.getAdminOrders(),this.data.length!==0?this.renderOrderPage():(o.setAttribute("disabled",""),E.classList.add("d-none"))},renderOrderPage(){i.innerHTML="";let a={},r={};this.data.forEach(d=>{d.products.forEach(t=>{a[t.title]===void 0?a[t.title]=t.price:a[t.title]+=t.price,r[t.category]===void 0?r[t.category]=t.price:r[t.category]+=t.price;const n=document.createElement("tr");i.appendChild(n);let e=document.createElement("td");e.textContent=d.id,n.appendChild(e),e=document.createElement("td"),n.appendChild(e);let s=document.createElement("p");s.textContent=d.user.name,e.appendChild(s),s=document.createElement("p"),s.textContent=d.user.tel,e.appendChild(s),e=document.createElement("td"),e.textContent=d.user.address,n.appendChild(e),e=document.createElement("td"),e.textContent=d.user.email,n.appendChild(e),e=document.createElement("td"),n.appendChild(e),s=document.createElement("p"),s.textContent=t.title,e.appendChild(s),e=document.createElement("td"),e.textContent=new Date(d.createdAt).toLocaleString().split(" ")[0],n.appendChild(e),e=document.createElement("td"),e.className="orderStatus",n.appendChild(e);const u=document.createElement("a");u.className="orderStatusLink",u.href="#",u.textContent=`${d.paid===!1?"未處理":"已處理"}`,e.appendChild(u),e=document.createElement("td"),n.appendChild(e);const l=document.createElement("input");l.className="delSingleOrder-Btn",l.type="button",l.value="刪除",l.setAttribute("data-id",d.id),e.appendChild(l),l.addEventListener("click",async v=>{i.parentElement.parentElement.previousElementSibling.previousElementSibling.classList.remove("d-none");const C=v.target.getAttribute("data-id");await this.deleteOrderById(C),this.data=await c.getAdminOrders(),this.renderOrderPage(),i.parentElement.parentElement.previousElementSibling.previousElementSibling.classList.add("d-none")})})}),this.renderItemC3(a),this.renderProductC3(r),E.classList.remove("d-none")},renderItemC3(a){const r=[];Object.keys(a).forEach((t,n)=>{let e=[t,Object.values(a)[n]];r.push(e)}),r.sort((t,n)=>n[1]-t[1]);let d=["其他",0];r.forEach((t,n)=>{n>=3&&(d[1]+=t[1])}),r.splice(3,r.length-3),r.push(d),c3.generate({bindto:"#chart",data:{type:"pie",columns:r,colors:{"Louvre 雙人床架":"#DACBFF","Antony 雙人床架":"#9D7FEA","Anty 雙人床架":"#5434A7",其他:"#301E5F"}}})},renderProductC3(a){let r=[];Object.keys(a).forEach((d,t)=>{let n=[d,Object.values(a)[t]];r.push(n)}),c3.generate({bindto:"#chart1",data:{type:"pie",columns:r,colors:{"Louvre 雙人床架":"#DACBFF","Antony 雙人床架":"#9D7FEA","Anty 雙人床架":"#5434A7",其他:"#301E5F"}}})},async deleteOrderById(a){await c.deleteOrderById(a),await c.getAdminOrders(),this.data!==0?this.renderOrderPage():o.setAttribute("disabled","")},async deleteAllOrders(){this.data.length!==0?(o.previousElementSibling.classList.remove("d-none"),this.data=await c.deleteAllOrders(),o.previousElementSibling.classList.add("d-none"),this.renderOrderPage()):console.log(0)}},E=document.querySelector(".chartSummaryTable"),o=document.querySelector(".discardAllBtn"),L=document.querySelector(".orderPage-table"),i=document.createElement("tbody");L.appendChild(i);y.init();o.addEventListener("click",a=>{a.preventDefault(),y.deleteAllOrders()});const m=document.querySelector(".mso-left"),p=document.querySelector(".mso-right"),h=document.querySelector(".chartProduct"),g=document.querySelector(".chartItem");m.addEventListener("click",a=>{h.classList.add("translateX-start-100"),g.classList.add("translateX-start-100"),m.classList.add("text-secondary"),m.classList.remove("msoHover"),p.classList.remove("text-secondary"),p.classList.add("msoHover")});p.addEventListener("click",a=>{h.className.includes("translateX-start-100")&&(g.classList.remove("translateX-start-100"),h.classList.remove("translateX-start-100"),p.classList.add("text-secondary"),p.classList.remove("msoHover"),m.classList.remove("text-secondary"),m.classList.add("msoHover"))});
