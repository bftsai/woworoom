import{a as u}from"./config-12ca6bfa.js";const c={name(t){const e=new RegExp("[A-Za-z一-龥\\x20]"),i=t.split(e);for(let l=0;l<i.length;l++)if(i[l]!=="")return!1;return!0},phone(t){return new RegExp("^09[0-9]{8}$").test(t)},mail(t){return new RegExp("^[\\w]+@[\\w]+\\.[\\w]{3,6}(\\.[\\w]{2,6})?$").test(t)},address(t){return t!==""}};function b(t,e,i,l){if(c.name(t.value)&&c.phone(e.value)&&c.mail(i.value)&&c.address(l.value))return!0}const S="http://localhost:5173/woworoom/pages/index.html",L=document.querySelector(".productWrap"),m=document.querySelector(".shoppingCart-table"),E={data:[],async init(){this.data=await u.getProduct(),this.data.length!==0&&this.renderProductWrap(),this.data=await u.getShoppingCar(),this.data.length===0?m.classList.add("d-none"):this.data.length!==0&&(console.log(this.data),m.classList.remove("d-none"),this.renderShoppingCart())},renderProductWrap(){L.innerHTML="",this.data.forEach(t=>{const e=document.createElement("li");e.className="productCard",L.appendChild(e);const i=document.createElement("h4");i.className="productType",i.textContent="新品";const l=document.createElement("img");l.src=t.images,l.alt="product pic";const h=document.createElement("a");h.className="addCardBtn",h.textContent="加入購物車",h.href="#",h.setAttribute("data-id",t.id);const r=document.createElement("h3");r.textContent=t.title;const p=document.createElement("del");p.className="originPrice",p.textContent=t.origin_price;const d=document.createElement("p");d.className="nowPrice",d.textContent=t.price,e.appendChild(i),e.appendChild(l),e.appendChild(h),e.appendChild(r),e.appendChild(p),e.appendChild(d),h.addEventListener("click",async v=>{v.preventDefault();const C=v.target.getAttribute("data-id");await u.addShoppingCar(C,1),this.data=await u.getShoppingCar(),this.data.length===0?m.classList.add("d-none"):this.data.length!==0&&(console.log(this.data),m.classList.remove("d-none"),this.renderShoppingCart())})})},async filterProduct(t){const e=await u.getProduct();let i=[];t==="全部"?this.data=e:(e.forEach(l=>{l.category===t&&i.push(l)}),this.data=i),this.renderProductWrap()},renderShoppingCart(){m.innerHTML="";let t=0;this.data.forEach(r=>{const p=document.createElement("tr");m.appendChild(p);let d=document.createElement("td");p.appendChild(d);const v=document.createElement("div");v.className="cardItem-title",d.appendChild(v);const C=document.createElement("img");C.src=r.product.images,C.alt="product pic";const f=document.createElement("p");f.textContent=r.product.title,v.appendChild(C),v.appendChild(f),d=document.createElement("td"),d.textContent=r.product.price,p.appendChild(d),d=document.createElement("td"),d.textContent=r.quantity,p.appendChild(d),d=document.createElement("td"),d.textContent=`NT$${r.product.price*r.quantity}`,p.appendChild(d),t+=r.product.price*r.quantity,d=document.createElement("td"),d.className="discardBtn",p.appendChild(d);const g=document.createElement("a");g.href="#",g.className="material-icons",g.textContent="clear",g.setAttribute("data-id",r.id),d.appendChild(g),g.addEventListener("click",async x=>{x.preventDefault();const y=x.target.getAttribute("data-id");await u.deleteShoppingCarById(y),this.data=await u.getShoppingCar(),this.data.length===0?m.classList.add("d-none"):this.data.length!==0&&(console.log(this.data),m.classList.remove("d-none"),this.renderShoppingCart())})});const e=document.createElement("tr");m.appendChild(e);let i=document.createElement("td");e.appendChild(i);const l=document.createElement("a");l.href="#",l.className="discardAllBtn",l.textContent="刪除所有品項",i.appendChild(l),i=document.createElement("td"),e.appendChild(i),i=document.createElement("td"),e.appendChild(i),i=document.createElement("td"),e.appendChild(i);const h=document.createElement("p");h.textContent="總金額",i.appendChild(h),i=document.createElement("td"),i.textContent=`NT$${t}`,e.appendChild(i),l.addEventListener("click",async r=>{r.preventDefault(),await u.deleteAllShoppingCar(),location.href=S})},async postOrder(t){await u.postOrder(t),this.data=await u.getShoppingCar(),this.data.length===0?m.classList.add("d-none"):this.data.length!==0&&(console.log(this.data),m.classList.remove("d-none"),this.renderShoppingCart())}};E.init();const w=document.querySelector(".productSelect");w.addEventListener("change",t=>{const e=t.target.value;E.filterProduct(e)});const B=document.querySelector(".orderInfo-btn"),I=document.querySelector(".orderInfo-form"),s=document.getElementById("customerName"),n=document.getElementById("customerPhone"),a=document.getElementById("customerEmail"),o=document.getElementById("customerAddress"),N=document.getElementById("tradeWay");B.addEventListener("click",async t=>{if(t.preventDefault(),I.classList.add("was-validated"),s.value===""?s.classList.add("is-invalid"):c.name(s.value)?s.classList.remove("is-invalid"):(s.classList.add("is-invalid"),s.nextElementSibling.textContent="姓名不得為數字或特殊標點符號，如：!、@、#、$、%、^、&、*"),s.addEventListener("keyup",e=>{s.value===""?(s.classList.add("is-invalid"),s.nextElementSibling.textContent="必填"):c.name(s.value)?s.classList.remove("is-invalid"):(s.classList.add("is-invalid"),s.nextElementSibling.textContent="姓名不得為數字或特殊標點符號，如：!、@、#、$、%、^、&、*")}),s.addEventListener("paste",e=>{s.value===""?(s.classList.add("is-invalid"),s.nextElementSibling.textContent="必填"):c.name(s.value)?s.classList.remove("is-invalid"):(s.classList.add("is-invalid"),s.nextElementSibling.textContent="姓名不得為數字或特殊標點符號，如：!、@、#、$、%、^、&、*")}),n.value===""?(n.classList.add("is-invalid"),n.nextElementSibling.textContent="必填"):c.phone(n.value)?n.classList.remove("is-invalid"):(n.classList.add("is-invalid"),n.nextElementSibling.textContent="電話格式錯誤，請輸入格式為0912345678"),n.addEventListener("keyup",e=>{n.value===""?(n.classList.add("is-invalid"),n.nextElementSibling.textContent="必填"):c.phone(n.value)?n.classList.remove("is-invalid"):(n.classList.add("is-invalid"),n.nextElementSibling.textContent="電話格式錯誤，請輸入格式為0912345678")}),n.addEventListener("paste",e=>{n.value===""?(n.classList.add("is-invalid"),n.nextElementSibling.textContent="必填"):c.phone(n.value)?n.classList.remove("is-invalid"):(n.classList.add("is-invalid"),n.nextElementSibling.textContent="電話格式錯誤，請輸入格式為0912345678")}),a.value===""?(a.classList.add("is-invalid"),a.nextElementSibling.textContent="必填"):c.mail(a.value)?a.classList.remove("is-invalid"):(a.classList.add("is-invalid"),a.nextElementSibling.textContent="Email格式錯誤，請輸入格式為test@mail.com"),a.addEventListener("keyup",e=>{a.value===""?(a.classList.add("is-invalid"),a.nextElementSibling.textContent="必填"):c.mail(a.value)?a.classList.remove("is-invalid"):(a.classList.add("is-invalid"),a.nextElementSibling.textContent="Email格式錯誤，請輸入格式為test@mail.com")}),a.addEventListener("paste",e=>{a.value===""?(a.classList.add("is-invalid"),a.nextElementSibling.textContent="必填"):c.mail(a.value)?a.classList.remove("is-invalid"):(a.classList.add("is-invalid"),a.nextElementSibling.textContent="Email格式錯誤，請輸入格式為test@mail.com")}),o.value===""?(o.classList.add("is-invalid"),o.nextElementSibling.textContent="必填"):o.classList.remove("is-invalid"),o.addEventListener("keyup",e=>{o.value===""?(o.classList.add("is-invalid"),o.nextElementSibling.textContent="必填"):o.classList.remove("is-invalid")}),o.addEventListener("paste",e=>{o.value===""?(o.classList.add("is-invalid"),o.nextElementSibling.textContent="必填"):o.classList.remove("is-invalid")}),b(s,n,a,o)){let e={};e.data={},e.data.user={},e.data.user.name=s.value,e.data.user.tel=n.value,e.data.user.email=a.value,e.data.user.address=o.value,e.data.user.payment=N.value,await E.postOrder(e),location.href=S}});
